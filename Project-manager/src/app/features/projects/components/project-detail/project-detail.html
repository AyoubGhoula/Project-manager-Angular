@if (project) {
<div class="rounded-2xl border border-slate-200 bg-white p-6 shadow-md">


  <div class="mb-4 flex items-start justify-between gap-4">
    <div>
      <h2 class="text-2xl font-bold text-slate-900">{{ project.name }}</h2>
      <p class="mt-1 text-sm text-slate-600">{{ project.description }}</p>
    </div>
    <span
      class="shrink-0 rounded-full px-3 py-1 text-xs font-semibold uppercase tracking-wide"
      [ngClass]="{
        'bg-green-100 text-green-700': project.status === 'Terminé',
        'bg-cyan-100 text-cyan-700': project.status === 'En cours',
        'bg-amber-100 text-amber-700': project.status === 'En attente'
      }"
    >
      {{ project.status }}
    </span>
  </div>


  <div class="mb-4">
    <div class="flex items-center justify-between text-sm text-slate-600 mb-1">
      <span class="font-semibold">Progression des tâches</span>
      <span class="font-bold text-slate-900">{{ getProgress() | number:'1.0-0' }}%</span>
    </div>
    <div class="h-3 w-full overflow-hidden rounded-full bg-slate-200">
      <div
        class="h-full rounded-full transition-all duration-500"
        [ngClass]="{
          'bg-green-500': getProgress() === 100,
          'bg-cyan-500': getProgress() > 0 && getProgress() < 100,
          'bg-slate-300': getProgress() === 0
        }"
        [ngStyle]="{ 'width': getProgress() + '%' }"
      ></div>
    </div>
  </div>

  
  <div class="mt-5">
    <div class="flex items-center justify-between mb-2">
      <p class="text-xs font-semibold uppercase tracking-[0.2em] text-slate-400">Tâches</p>
      <button
        (click)="showAddForm = !showAddForm"
        class="rounded-lg px-3 py-1.5 text-xs font-semibold transition cursor-pointer"
        [ngClass]="{
          'bg-cyan-600 text-white hover:bg-cyan-700': !showAddForm,
          'bg-slate-200 text-slate-700 hover:bg-slate-300': showAddForm
        }"
      >
        @if (!showAddForm) {
          + Ajouter une tâche
        } @else {
          Annuler
        }
      </button>
    </div>


    @if (showAddForm) {
    <div class="mb-4 rounded-xl border border-cyan-200 bg-cyan-50 p-4">
      <div class="flex flex-col gap-3 sm:flex-row sm:items-end">
        <div class="flex-1">
          <label class="mb-1 block text-xs font-semibold text-slate-600">Titre de la tâche</label>
          <input
            [(ngModel)]="newTaskTitle"
            placeholder="Nom de la tâche..."
            class="w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-cyan-500 focus:outline-none focus:ring-2 focus:ring-cyan-200"
          />
        </div>
        <div>
          <label class="mb-1 block text-xs font-semibold text-slate-600">Priorité</label>
          <select
            [(ngModel)]="newTaskPriority"
            class="rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900 focus:border-cyan-500 focus:outline-none focus:ring-2 focus:ring-cyan-200"
          >
            <option value="Haute">Haute</option>
            <option value="Moyenne">Moyenne</option>
            <option value="Basse">Basse</option>
          </select>
        </div>
        <button
          (click)="addTask()"
          [disabled]="!newTaskTitle.trim()"
          class="rounded-lg bg-cyan-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-cyan-700 disabled:cursor-not-allowed disabled:opacity-50 cursor-pointer"
        >
          Ajouter
        </button>
      </div>
    </div>
    }

    @if (project.tasks.length === 0) {
      <p class="text-sm text-slate-500 italic">Aucune tâche</p>
    } @else {
      <app-task-list
        [tasks]="project.tasks"
        (statusChanged)="onStatusChanged($event)"
        (taskDeleted)="onTaskDeleted($event)"
      ></app-task-list>
    }
  </div>
</div>
}
